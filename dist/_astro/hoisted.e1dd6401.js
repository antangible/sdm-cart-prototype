netlifyIdentity.currentUser();var d=document.querySelector("#auth"),m=document.querySelector("#identity-menu");netlifyIdentity.on("login",function(s){p()});netlifyIdentity.on("logout",function(s){S()});function p(){d.style.display="block",m.classList.add("logged-in")}function S(){d.style.display="none",m.classList.remove("logged-in")}if(document.querySelector(".cart")){let s=function(){const l=document.querySelectorAll(".product"),e=JSON.parse(localStorage.getItem("cart"))||{};l.forEach(n=>{const i=n.getAttribute("data-product"),u=n.getAttribute("data-category"),o=n.querySelector(".product-quantity"),c=n.querySelector(".remove-quantity"),a=parseFloat(n.querySelector(".product-price").textContent);e[i]?(o.textContent=e[i].quantity,e[i].quantity===0&&(c.disabled=!0)):(e[i]={price:a,quantity:0,category:u},localStorage.setItem("cart",JSON.stringify(e))),n.querySelector(".add-quantity").addEventListener("click",()=>{let t=parseInt(o.textContent);t++,o.textContent=t,c.disabled=!1,e[i].quantity=t,localStorage.setItem("cart",JSON.stringify(e)),r()}),n.querySelector(".remove-quantity").addEventListener("click",()=>{let t=parseInt(o.textContent);t>0&&(t--,o.textContent=t,t===0&&(c.disabled=!0),e[i].quantity=t,localStorage.setItem("cart",JSON.stringify(e)),r())})}),r()},r=function(){const l=document.getElementById("cart-items"),e=document.getElementById("cart-total"),n=JSON.parse(localStorage.getItem("cart"))||{};let i=0,u=0;l.innerHTML="";for(const c in n){const a=n[c];if(i+=a.price*a.quantity,u+=a.quantity,a.quantity>0){const t=document.createElement("li");t.className="cart-item";const q=a.price*a.quantity,f=a.category?`<span class="category-name">${a.category}</span>`:"";t.innerHTML=`
              <div>${f}</div>
              <div class="product-name mt-1">${c}</div>
              <div class="d-flex justify-content-between mt-1">
                <span class="quantity">${a.quantity}x</span>
                <span class="item-total">${q.toFixed(2)}â‚¬</span>
              </div>
          `,l.appendChild(t)}}const o=document.getElementById("total-items");o.textContent=`${u} articoli`,e.textContent=`${i.toFixed(2)}`,localStorage.setItem("cart",JSON.stringify(n))};var v=s,I=r;s();const g=document.getElementById("show-cart-items"),y=document.querySelector(".overlay");g.addEventListener("change",function(){this.checked?y.classList.add("is-visible"):y.classList.remove("is-visible")})}
